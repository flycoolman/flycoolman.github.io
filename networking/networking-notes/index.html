<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Hongwei Li">

  
  
  
    
  
  <meta name="description" content="A brief of networking knowledge.">

  
  <link rel="alternate" hreflang="en-us" href="/networking/networking-notes/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146441609-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-146441609-3', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu42a5118afc49636e6fda7ce5d4b48056_3366_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu42a5118afc49636e6fda7ce5d4b48056_3366_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/networking/networking-notes/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@flycoolman">
  <meta property="twitter:creator" content="@flycoolman">
  
  <meta property="og:site_name" content="flycoolman">
  <meta property="og:url" content="/networking/networking-notes/">
  <meta property="og:title" content="Networking Notes | flycoolman">
  <meta property="og:description" content="A brief of networking knowledge."><meta property="og:image" content="/networking/networking-notes/featured.png">
  <meta property="twitter:image" content="/networking/networking-notes/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-09-10T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-09-23T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Networking Notes | flycoolman</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">flycoolman</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">flycoolman</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Coding</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/coding/python/"><span>Python</span></a>
            
              <a class="dropdown-item" href="/coding/java/"><span>Java</span></a>
            
              <a class="dropdown-item" href="/coding/go/"><span>Go</span></a>
            
              <a class="dropdown-item" href="/coding/javascript/"><span>JavaScript</span></a>
            
              <a class="dropdown-item" href="/coding/html/"><span>HTML</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/linux/"><span>Linux</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/devops/"><span>DevOps</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/networking/"><span>Networking</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  


<div class="article-container pt-3">
  <h1>Networking Notes</h1>

  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span ><a href="/author/hongwei-li/">Hongwei Li</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Sep 23, 2021
  </span>
  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/networking/">Networking</a></span>
  

</div>

  














</div>


<div class="article-header container featured-image-wrapper mt-4 mb-4" style="max-width: 580px; max-height: 218px;">
  <div style="position: relative">
    <img src="/networking/networking-notes/featured.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <hr>
<p>
<a href="#ospf">OSPF</a><br>

<a href="#is-is">IS-IS</a><br>

<a href="#bgp">BGP</a><br>

<a href="#vxlan">VXLAN</a><br>

<a href="#evpn">EVPN</a><br>

<a href="#sr">SR</a><br>

<a href="#mpls-sr">MPLS SR</a><br>

<a href="#srv6">SRv6</a></p>
<hr>
<h2 id="ospf">OSPF</h2>
<h3 id="route-types">Route types</h3>
<ul>
<li>Intra-Area (O)</li>
<li>Inter-Area (O IA)</li>
<li>External Type 1 (E1)</li>
<li>NSSA Type 1 (N1)</li>
<li>External Type 2 (E2)</li>
<li>NSSA Type 2 (N2)</li>
</ul>
<p>A type 1 route has a metric that is the sum of the internal OSPF cost and the external redistributed cost. A type 2 route has a metric equal only to the redistributed cost.</p>
<h3 id="packet">Packet</h3>
<ul>
<li>IP, 89</li>
<li>5 Types
<ul>
<li>Hello</li>
<li>DD (Database Description)</li>
<li>LSR (Link State Request)</li>
<li>LSU (Link State Update)</li>
<li>LSAck (Link State Acknowledgement)</li>
</ul>
</li>
</ul>
<p>LSA (Link State Advertisement)
LSDB (Link State Database)</p>
<h3 id="lsa-types">LSA Types</h3>
<ul>
<li>Router LSA (Type-1) By Router</li>
<li>Network LSA（Type-2) by DR</li>
<li>Network Summary LSA（Type-3） by ABR (Area Border Router)</li>
<li>ASBR Summary LSA（Type-4) by ABR</li>
<li>AS External LSA（Type-5） by ASBR</li>
<li>NSSA External LSA（Type-7） by ASBR in NSSA (Not-so-stubby Area)</li>
<li>Opaque LSA
<ul>
<li>Type 9 (Grace LSA), for GR (Grace Restart), link local</li>
<li>Type 10, flood in area</li>
<li>Type 11, flood in AS</li>
</ul>
</li>
</ul>
<h3 id="area">Area</h3>
<ul>
<li>Backbone area</li>
<li>Normal area</li>
<li>Stub area</li>
<li>Totally Stub area</li>
<li>NSSA</li>
<li>Totally NSSA</li>
</ul>
<p>Virtual link, transit area</p>
<h3 id="router-types">Router Types</h3>
<ul>
<li>Internal Router</li>
<li>ABR</li>
<li>Backbone Router</li>
<li>ASBR</li>
</ul>
<h3 id="network-types">Network Types</h3>
<ul>
<li>Broadcast, 224.0.0.5 (224.0.0.6 for DR/BDR)</li>
<li>NBMA, unicast</li>
<li>P2MP, 224.0.0.5</li>
<li>P2P, 224.0.0.5</li>
</ul>
<h3 id="drbdr">DR/BDR</h3>
<ul>
<li>DR/BDR</li>
<li>DR other</li>
</ul>
<h3 id="drbdr-election">DR/BDR Election</h3>
<p>Priority + Router ID</p>
<ol>
<li>Priority &gt; 0</li>
<li>Priority higher</li>
<li>Router ID higher</li>
</ol>
<h3 id="neighbor-states">Neighbor States</h3>
<p>
<a href="https://www.cisco.com/c/en/us/support/docs/ip/open-shortest-path-first-ospf/13685-13.html" target="_blank" rel="noopener">OSPF Neighbor States</a></p>
<ul>
<li>Down</li>
<li>Attempt (only in NBMA)</li>
<li>Init</li>
<li>2-Way</li>
<li>ExStart</li>
<li>Exchange</li>
<li>Loading</li>
<li>Full</li>
</ul>
<h3 id="neighborship-on-ethernet">Neighborship on Ethernet</h3>
<p>
<a href="https://www.firewall.cx/networking-topics/routing/ospf-routing-protocol/1142-ospf-adjacency-neighbor-states-forming-process.html" target="_blank" rel="noopener">OSPF NEIGHBOR STATES – OSPF NEIGHBOR FORMING PROCESS</a><br>
Down&mdash;&gt;Init&mdash;&gt;2-Way&mdash;(DR Election)&mdash;&gt;ExStart&mdash;(DD)&mdash;&gt;Exchange(DD)&mdash;&gt;Loading&mdash;(LSR,LSU,LSAck)&mdash;&gt;Full</p>
<hr>
<h2 id="is-is">IS-IS</h2>
<p>IS-IS（Intermediate System-to-Intermediate System)</p>
<ul>
<li>IS (Intermediate System)</li>
<li>ES（End System）</li>
<li>RD（Routing Domain）</li>
<li>Area</li>
<li>LSDB (Link State DataBase)</li>
<li>LSPDU (Link State Protocol Data Unit)</li>
<li>NPDU（Network Protocol Data Unit）</li>
<li>DIS (Designated IS)</li>
<li>NSAP（Network Service Access Point）</li>
</ul>
<h3 id="is-is-address-nsap-address">IS-IS Address (NSAP Address)</h3>
<p>
<a href="https://sites.google.com/site/amitsciscozone/is-is/nsap-addresses?authuser=0" target="_blank" rel="noopener">NSAP Addresses</a></p>
<h4 id="idp--dsp">IDP + DSP</h4>
<p><img src="isis-address.png" alt="isis-address.png"><br>
IS-IS Address = IDP + DSP = (AFI + IDI) + (HO-DSP + ID + SEL)<br>
<strong>IS-IS Address = Area address + System ID + SEL</strong>
Area Address = AFI + IDI + HO-DSP
IDP = AFI + IDI<br>
DSP = HO-DSP + ID + SEL</p>
<ul>
<li>
<p>IDP（Initial Domain Part）</p>
</li>
<li>
<p>DSP（Domain Specific Part）</p>
</li>
<li>
<p>AFI（Authority and Format Identifier)</p>
</li>
<li>
<p>IDI（Initial Domain Identifier）</p>
</li>
<li>
<p>HO-DSP（High Order Part of DSP</p>
</li>
<li>
<p>SEL, a.k.a. N-SEL（NSAP Selector）</p>
</li>
<li>
<p>ID, a.k.a. System ID</p>
</li>
</ul>
<h3 id="router-types-1">Router Types</h3>
<ul>
<li>Level-1 Router</li>
<li>Level-2 Router</li>
<li>Level-1-2 Router, has two LSDB</li>
</ul>
<p><img src="isis-levels.png" alt="isis-levels"></p>
<p><img src="isis-adjacency.png" alt="isis-adjacency"><br>

<a href="https://www.cisco.com/c/en/us/support/docs/ip/integrated-intermediate-system-to-intermediate-system-is-is/200293-IS-IS-Adjacency-and-Area-Types.html" target="_blank" rel="noopener">IS-IS Adjacency and Area Types</a></p>
<h3 id="network-types-1">Network Types</h3>
<ul>
<li>Broadcast</li>
<li>P2P</li>
</ul>
<h3 id="dis">DIS</h3>
<ul>
<li>Level-1 and Level-2 have their own DIS</li>
<li>Priority &gt;= 0, not &gt; 0</li>
<li>Priority &gt; SNPA address</li>
<li>Highest Priority &mdash;&gt; Largest SNPA(MAC)</li>
</ul>
<p>SNPA is MAC in Broadcast network</p>
<p><img src="isis-neighbors.png" alt="isis-neighbors"><br>

<a href="https://sites.google.com/site/amitsciscozone/is-is/designated-is?authuser=0" target="_blank" rel="noopener">Designated IS</a></p>
<ul>
<li>All routers have adjency with other routers in the same level, <strong>NOT</strong> only with DIS.</li>
<li>DIS to sync up LSDB.</li>
<li>DIS to create and update Pseudonode.</li>
<li>All routers on the broadcast network, including the DIS, form adjacencies with the Pseudonode.</li>
<li>The DIS assigns the LAN ID (similar to System ID) to the broadcast network. The LAN ID is created by concatenating the System ID of the DIS with its Circuit ID (Pseudonode ID, in this case) for the attached network. All routers on the network will use the LAN ID assigned by the DIS.</li>
</ul>
<h3 id="is-is-packet">IS-IS Packet</h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>PDU</th>
<th>Abbr.</th>
</tr>
</thead>
<tbody>
<tr>
<td>15</td>
<td>Level-1 LAN IS-IS Hello PDU</td>
<td>L1 LAN IIH</td>
</tr>
<tr>
<td>16</td>
<td>Level-2 LAN IS-IS Hello PDU</td>
<td>L2 LAN IIH</td>
</tr>
<tr>
<td>17</td>
<td>Point-to-Point IS-IS Hello PDU</td>
<td>P2P IIH</td>
</tr>
<tr>
<td>18</td>
<td>Level-1 Link State PDU</td>
<td>L1 LSP</td>
</tr>
<tr>
<td>20</td>
<td>Level-2 Link State PDU</td>
<td>L2 LSP</td>
</tr>
<tr>
<td>24</td>
<td>Level-1 Complete Sequence Numbers PDU</td>
<td>L1 CSNP</td>
</tr>
<tr>
<td>25</td>
<td>Level-2 Complete Sequence Numbers PDU</td>
<td>L2 CSNP</td>
</tr>
<tr>
<td>26</td>
<td>Level-1 Partial Sequence Numbers PDU</td>
<td>L1 PSNP</td>
</tr>
<tr>
<td>27</td>
<td>Level-2 Partial Sequence Numbers PDU</td>
<td>L2 PSNP</td>
</tr>
</tbody>
</table>
<ul>
<li>Hello (IS-to-IS Hello PDUs), Level-1 LAN IIH, Level-2 LAN IIH, P2P IIH</li>
<li>LSP Link state packet (LSP)</li>
<li>SNP (Sequence Number Packet)
<ul>
<li>PSNP<br>
PSNP only lists one or more last received LSP sequence numbers, and confirms multiple LSPs. When detecting asynchronous LSDBs, the system asks neighbors to send new LSPs by PSNPs.</li>
<li>CSNP<br>
CSNP contains all LSP digest information in an LSDB, synchronizing LSDBs for neighbor routers.</li>
</ul>
</li>
</ul>
<h3 id="is-is-adjacency-states">IS-IS Adjacency States</h3>
<p>There are only three adjacency states in IS-IS.<br>
Down&mdash;&ndash;&gt;Initializing&mdash;&mdash;&gt;Up</p>
<ul>
<li>
<p>Down<br>
This is the initial state. Its means that no hellos have been received from the neighbor.</p>
</li>
<li>
<p>Initializing<br>
This state means that the local router has successfully received hellos from the neighboring router, however it’s not sure that the neighboring router has also successfully received local router’s hellos.</p>
</li>
<li>
<p>Up<br>
Now it’s confirmed that neighboring router is receiving local router’s hellos.</p>
</li>
</ul>
<hr>
<h2 id="bgp">BGP</h2>
<h3 id="message-types">Message Types</h3>
<ul>
<li>Open</li>
<li>Update</li>
<li>Keepalive</li>
<li>Route-refresh</li>
<li>Notification</li>
</ul>
<h3 id="bgp-attributes">BGP Attributes</h3>
<p>
<a href="https://techhub.hpe.com/eginfolib/networking/docs/switches/K-KA-KB/15-18/5998-8164_mrg/content/ch15s07.html" target="_blank" rel="noopener">BGP path attributes</a></p>
<ol>
<li>Origin (IGP, EGP, Incomplete)</li>
<li>AS_PATH (Avoid loop, Route selection, Route filtering)
<ul>
<li>AS_SEQUENCE</li>
<li>AS_SET</li>
</ul>
</li>
<li>NEXT_HOP</li>
<li>MED（Multi-Exit Discriminator)</li>
<li>LOCAL_PREF (IBGP only, the higher, the better)</li>
<li>COMMUNITY (4 bytes)
<ul>
<li>INTERNET      &mdash;        to all BGP neighbors</li>
<li>NO_EXPORT     &mdash;        NOT beyond local AS or confederation (OK to sub-as)</li>
<li>NO_ADVERTISE  &mdash;        NOT to any BGP neighbors</li>
<li>NO_EXPORT_SUBCONFED  &mdash; NOT beyond local AS or confederation (NOT to sub-as)</li>
</ul>
</li>
<li>EXTENDED COMMUNITY (8 bytes)
<ul>
<li>VPN target</li>
<li>SoO (Site of Origin), avoid loop
<ul>
<li>an 16 bits autonomous system number and an arbitrary number, i.e. 101:3</li>
<li>an IP address and an arbitrary number, i.e. 192.168.122.15:1</li>
<li>an 32 bits autonomous system number and an arbitrary number, i.e. 65536:1</li>
</ul>
</li>
</ul>
</li>
</ol>
<table>
<thead>
<tr>
<th>Name</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td>ORIGIN</td>
<td>Well-known mandatory</td>
</tr>
<tr>
<td>AS_PATH</td>
<td>Well-known mandatory</td>
</tr>
<tr>
<td>NEXT_HOP</td>
<td>Well-known mandatory</td>
</tr>
<tr>
<td>LOCAL_PREF</td>
<td>Well-known discretionary</td>
</tr>
<tr>
<td>ATOMIC_AGGREGATE</td>
<td>Well-known discretionary</td>
</tr>
<tr>
<td>COMMUNITY Optional</td>
<td>transitive</td>
</tr>
<tr>
<td>MULTI_EXIT_DISC (MED)</td>
<td>Optional non-transitive</td>
</tr>
<tr>
<td>ORIGINATOR_ID</td>
<td>Optional non-transitive</td>
</tr>
<tr>
<td>CLUSTER_LIST</td>
<td>Optional non-transitive</td>
</tr>
</tbody>
</table>
<h3 id="path-selection">Path Selection</h3>
<p>
<a href="https://www.cisco.com/c/en/us/support/docs/ip/border-gateway-protocol-bgp/13753-25.html" target="_blank" rel="noopener">BGP Best Path Selection Algorithm</a></p>
<ol>
<li>Prefer the path with the highest WEIGHT.</li>
<li>Prefer the path with the highest LOCAL_PREF.</li>
<li>Prefer the path that was locally originated via a network or aggregate BGP subcommand or through redistribution from an IGP.<br>
Local paths that are sourced by the network or redistribute commands are preferred over local aggregates that are sourced by the aggregate-address command.</li>
<li>Prefer the path with the shortest AS_PATH.</li>
<li>Prefer the path with the lowest origin type.</li>
<li>Prefer the path with the lowest multi-exit discriminator (MED).</li>
<li>Prefer eBGP over iBGP paths.<br>
If bestpath is selected, go to Step 9 (multipath).</li>
<li>Prefer the path with the lowest IGP metric to the BGP next hop.<br>
Continue, even if bestpath is already selected.</li>
<li>Determine if multiple paths require installation in the routing table for BGP Multipath.<br>
Continue, if bestpath is not yet selected.</li>
<li>When both paths are external, prefer the path that was received first (the oldest one).</li>
<li>Prefer the route that comes from the BGP router with the lowest router ID.</li>
<li>If the originator or router ID is the same for multiple paths, prefer the path with the minimum cluster list length.</li>
<li>Prefer the path that comes from the lowest neighbor address.</li>
</ol>
<h3 id="bgp-neighbor-states">BGP Neighbor States</h3>
<ul>
<li>Idle</li>
<li>Connect</li>
<li>Active</li>
<li>OpenSent</li>
<li>OpenConfirm</li>
<li>Established
<img src="bgp-state-machine.jpg" alt="BGP state machine"></li>
</ul>
<h3 id="bgp-route-advertisement-rules">BGP Route Advertisement Rules</h3>
<p>
<a href="https://techhub.hpe.com/eginfolib/networking/docs/switches/5930/5200-4579_l3-ip-rtng_cg/content/491335171.htm" target="_blank" rel="noopener">BGP route advertisement rules</a></p>
<ul>
<li>When multiple feasible routes to a destination exist, BGP advertises only the optimal route to its peers. If the advertise-rib-active command is configured, BGP advertises the optimal route in the IP routing table. If not, BGP advertises the optimal route in the BGP routing table.</li>
<li>BGP advertises only routes that it uses.</li>
<li>BGP advertises routes learned from an EBGP peer to all BGP peers, including both EBGP and IBGP peers.</li>
<li>BGP advertises routes learned from an IBGP peer to EBGP peers, rather than other IBGP peers.</li>
<li>After establishing a session with a new BGP peer, BGP advertises all the routes matching the above rules to the peer. After that, BGP advertises only incremental updates to the peer.</li>
</ul>
<hr>
<h2 id="vxlan">VXLAN</h2>
<h3 id="vxlan-terms">VXLAN Terms</h3>
<ul>
<li>VXLAN（Virtual eXtensible LAN)</li>
<li>MAC in UDP</li>
<li>2^24(16777216) VXLAN</li>
<li>Underlay vs Overlay</li>
<li>VXLAN ID, a.k.a. VNI (VXLAN Network Identifier)</li>
<li>VTEP (VXLAN Tunnel End Point)</li>
<li>VXLAN Tunnel</li>
<li>VSI (Virtual Switch Instance), 1:1 mapping to VXLAN</li>
</ul>
<h3 id="vxlan-packet-format">VXLAN Packet Format</h3>
<ul>
<li>8-byte VXLAN header—VXLAN information for the frame.
<ul>
<li>Flags—If the I bit is 1, the VXLAN ID is valid. If the I bit is 0, the VXLAN ID is invalid. All other bits are reserved and set to 0.</li>
<li>24-bit VXLAN ID—Identifies the VXLAN of the frame. It is also called the virtual network identifier (VNI).</li>
</ul>
</li>
<li>8-byte outer UDP header for VXLAN—The default VXLAN destination UDP port number is 4789.</li>
<li>20-byte outer IP header—Valid addresses of VTEPs or VXLAN multicast groups on the transport network. Devices in the transport network forward VXLAN packets based on the outer IP header.
<img src="vxlan-packet-format.png" alt="vxlan-packet-format"></li>
</ul>
<hr>
<h2 id="evpn">EVPN</h2>
<hr>
<h2 id="sr">SR</h2>
<hr>
<h2 id="mpls-sr">MPLS SR</h2>
<hr>
<h2 id="srv6">SRv6</h2>
<hr>
<br>
<h4 id="did-you-find-this-page-helpful-consider-sharing-it-">Did you find this page helpful? Consider sharing it 🙌</h4>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/networking/">Networking</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/networking/networking-notes/&amp;text=Networking%20Notes" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/networking/networking-notes/&amp;t=Networking%20Notes" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Networking%20Notes&amp;body=/networking/networking-notes/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/networking/networking-notes/&amp;title=Networking%20Notes" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Networking%20Notes%20/networking/networking-notes/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/networking/networking-notes/&amp;title=Networking%20Notes" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/hongwei-li/avatar_hu33d8f2710ea4928d295bd08cdc05f6eb_17524_270x270_fill_q90_lanczos_center.jpg" alt="Hongwei Li">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/">Hongwei Li</a></h5>
        <h6 class="card-subtitle">Software, Networking</h6>
        <p class="card-text">Always on the way - Coding, DevOps, Networking.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:flycoolman@gmail.com" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/flycoolman" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/flycoolman" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  


  
















  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    ©2022 flycoolman.com All Rights Reserved
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
